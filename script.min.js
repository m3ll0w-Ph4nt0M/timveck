(function(){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}
const savedConsent=localStorage.getItem('cookieConsent');if(savedConsent==='accepted'){gtag('consent','update',{'ad_storage':'granted','ad_user_data':'granted','ad_personalization':'granted','analytics_storage':'granted','functionality_storage':'granted','personalization_storage':'granted','security_storage':'granted'})}else if(savedConsent==='rejected'){gtag('consent','update',{'ad_storage':'denied','ad_user_data':'denied','ad_personalization':'denied','analytics_storage':'denied','functionality_storage':'denied','personalization_storage':'denied','security_storage':'granted'})}
const banner=document.getElementById('cookie-consent-banner');const acceptBtn=document.getElementById('accept-all-cookies');const rejectBtn=document.getElementById('reject-necessary-cookies');if(!savedConsent&&banner){banner.style.display='flex'}
if(acceptBtn){acceptBtn.addEventListener('click',function(){gtag('consent','update',{'ad_storage':'granted','ad_user_data':'granted','ad_personalization':'granted','analytics_storage':'granted','functionality_storage':'granted','personalization_storage':'granted','security_storage':'granted'});banner.style.display='none';localStorage.setItem('cookieConsent','accepted')})}
if(rejectBtn){rejectBtn.addEventListener('click',function(){gtag('consent','update',{'ad_storage':'denied','ad_user_data':'denied','ad_personalization':'denied','analytics_storage':'denied','functionality_storage':'denied','personalization_storage':'denied','security_storage':'granted'});banner.style.display='none';localStorage.setItem('cookieConsent','rejected')})}
document.addEventListener('DOMContentLoaded',()=>{const elements={footer:document.querySelector('.footer-bottom p'),menuBtn:document.getElementById('menu-btn'),closeBtn:document.getElementById('close-btn'),navMenu:document.querySelector('.nav-menu'),links:document.querySelectorAll('.nav-menu a'),backToTop:document.getElementById('back-to-top'),contactForm:document.getElementById('contact-form'),formPass:document.getElementById('form-pass'),formFail:document.getElementById('form-fail'),formSuccessMsg:document.getElementById('form-success-msg')};if(elements.contactForm){elements.contactForm.addEventListener("submit",async function(event){event.preventDefault();const data=new FormData(event.target);fetch(event.target.action,{method:elements.contactForm.method,body:data,headers:{'Accept':'application/json'}}).then(response=>{if(response.ok){if(elements.formPass)elements.formPass.style.display='none';if(elements.formFail)elements.formFail.style.display='none';if(elements.formSuccessMsg)elements.formSuccessMsg.style.display='block'}else{if(elements.formFail){elements.formFail.innerText="Oops! Please refresh and try again"}}}).catch(error=>{if(elements.formFail){elements.formFail.innerText="Oops! Please refresh and try again"}})})}
const handlePopups=()=>{const isDesktop=window.innerWidth>768;const targets='.img-wrapper';if(isDesktop&&typeof tippy==='function'){tippy(targets,{placement:'top',animation:'fade',followCursor:!0,theme:'light-border',arrow:!0,maxWidth:200,})}else{document.querySelectorAll(targets).forEach(el=>{if(el._tippy)el._tippy.destroy()})}};handlePopups();let resizeTimer;window.addEventListener('resize',()=>{clearTimeout(resizeTimer);resizeTimer=setTimeout(handlePopups,200)});if(elements.footer){elements.footer.innerText=`Â© ${new Date().getFullYear()} TimVeck - IT Business English Training. All rights reserved.`}
const toggleMenu=(state)=>{if(!elements.navMenu)return;elements.navMenu.classList.toggle('active',state);elements.menuBtn?.classList.toggle('open',state);document.body.style.overflow=state?'hidden':''};elements.menuBtn?.addEventListener('click',()=>toggleMenu(!0));elements.closeBtn?.addEventListener('click',()=>toggleMenu(!1));elements.links.forEach(link=>link.addEventListener('click',()=>toggleMenu(!1)));if(elements.backToTop){window.addEventListener('scroll',()=>{elements.backToTop.classList.toggle('visible',window.scrollY>400)});elements.backToTop.addEventListener('click',()=>{window.scrollTo({top:0,behavior:'smooth'})})}
const currentPath=window.location.pathname;elements.links.forEach(link=>{const href=link.getAttribute('href');const isHome=(currentPath==='/'||currentPath.endsWith('index.html'));const isHomeLink=(href==='index.html'||href==='/'||href==='./');if(isHome&&isHomeLink){link.setAttribute('aria-current','page')}else if(href!=='index.html'&&href!=='/'&&href!=='./'&&currentPath.endsWith(href)){link.setAttribute('aria-current','page')}else{link.removeAttribute('aria-current')}})})})()